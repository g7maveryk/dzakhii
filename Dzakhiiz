local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

local Remotes = ReplicatedStorage and ReplicatedStorage:FindFirstChild("Remotes")
local Functions = Remotes and Remotes:FindFirstChild("Functions")
local Events = Remotes and Remotes:FindFirstChild("Events")

local CombatRemote = Functions and Functions:FindFirstChild("CombatRF")
local CollectionRemote = Functions and Functions:FindFirstChild("CollectionRF")
local HatchRemote = Events and Events:FindFirstChild("HatchEggEvent")
local PlantRemote = Events and Events:FindFirstChild("PlantEggEvent")
local FeedRemote = Events and Events:FindFirstChild("FeedEggEvent")
local SacrificeRemote = Functions and Functions:FindFirstChild("SacrificeFunction")
local ZonesRF = Functions and Functions:FindFirstChild("ZonesRF")

local function safeCombat(...)
    if CombatRemote then
        pcall(CombatRemote.InvokeServer, CombatRemote, ...)
    end
end

local function safeCollect(...)
    if CollectionRemote then
        pcall(CollectionRemote.InvokeServer, CollectionRemote, ...)
    end
end

local function safeHatch()
    if HatchRemote then
        pcall(HatchRemote.FireServer, HatchRemote)
    end
end

local function safePlant(zone)
    if PlantRemote then
        pcall(PlantRemote.FireServer, PlantRemote, zone)
    end
end

local function safeFeed(nest)
    if FeedRemote then
        pcall(FeedRemote.FireServer, FeedRemote, nest)
    end
end

local function safeSacrifice(pet)
    if SacrificeRemote then
        pcall(SacrificeRemote.InvokeServer, SacrificeRemote, "SacrificeWell", pet)
    end
end

local function requestZoneMap(zone)
    if ZonesRF then
        pcall(ZonesRF.InvokeServer, ZonesRF, "RequestZoneMap", zone)
    end
end

local active = false
local eggsSelected = {}
local bossEnabled = {}
local zoneCache = {}
local activeBosses = {}
local jumpConnection = nil
local jumpCount = 0
local petCache = {}
local petCacheValid = false
local nestsCache = nil
local lastNestCacheUpdate = 0
local loopThreads = {}
local startDebounce = false

local floodCounter = 0
local lastFloodTime = os.clock()
local lastActivity = os.clock()
local cycleCount = 0
local lastCheckpoint = os.clock()
local checkpointData = {}

local performance = {
    lastFrameTime = os.clock(),
    fps = 60,
    mode = "normal"
}

local function updateActivity()
    lastActivity = os.clock()
end

local bossZoneMap = {
    Naga = "Zone2B1",
    ["Lava Monster"] = "Zone5B1",
    ["Tiki Monster"] = "Zone10B1",
    ["The Frozen Ancient"] = "Zone12B1",
    ["The Big 100M"] = "Zone12B3",
    ["The Ethereal Everia"] = "Zone12B2",
    ["Hornet Boss"] = "SummerEventZoneB1",
    ["The Ice Serpent"] = "WinterEventZoneB1",
    ["Great Sphinx"] = "ElementEventZoneB1",
}

local enemyList = {
    { name = "Summer", zone = "SummerEventZone", attackAll = true },
    { name = "Winter", zone = "WinterEventZone", attackAll = true },
    { name = "Sphinx (Evil Eagle)", zone = "ElementEventZone1", enemy = "Evil Eagle", needsRequest = true },
    { name = "Cursed Mummy", zone = "Zone2", enemy = "Cursed Mummy", needsRequest = true },
    { name = "Crazy Unicorn", zone = "Zone5", enemy = "Crazy Unicorn", needsRequest = true },
    { name = "Terror Tree", zone = "Zone10", enemy = "Terror Tree", needsRequest = true },
    { name = "Draco's Guard", zone = "Zone12", enemy = "Draco's Guard", needsRequest = true },
}

local enemyEnabled = {}
for i, enemy in ipairs(enemyList) do
    enemyEnabled[i] = false
end

local foodZones = {
    { name = "Crystal Food (Zone12.1)", zone = "Zone12.1", enabled = false },
    { name = "Draco Food (Zone12)", zone = "Zone12", enabled = false },
}

local config = {
    farmBosses = false,
    bossSpeed = 0.03,
    bossThreads = 3,
    foodSpeed = 0.01,
    foodThreads = 5,
    enemyThreads = 5,
    autoPlant = false,
    autoHatch = false,
    autoNests = false,
    sacrificeLoopQueen = false,
    sacrificeLoopKing = false,
    sacrificeLoopFrozen = false,
    sacrificeLoopWalrus = false,
    doubleJump = false,
    wallspeed = 16,
}

local bossList = {
    "Naga", "Lava Monster", "Tiki Monster",
    "The Frozen Ancient", "The Big 100M", "The Ethereal Everia",
    "Hornet Boss", "The Ice Serpent", "Great Sphinx"
}
for _, name in ipairs(bossList) do bossEnabled[name] = true end

local zoneList = {
    "SummerEvent1", "WinterEvent1", "EleEgg1", "6", "4", "15", "10", "27",
    "30", "11", "34", "12.1", "1", "3", "7", "8", "9", "12", "13", "14",
    "Boss1", "Boss2", "Boss4",
    "SummerEventZone", "WinterEventZone", "Zone12.1", "ElementEventZone1",
    "Zone2", "Zone5", "Zone10", "Zone12",
    "Zone2B1", "Zone5B1", "Zone10B1", "Zone12B1", "Zone12B3", "Zone12B2",
    "SummerEventZoneB1", "WinterEventZoneB1", "ElementEventZoneB1"
}
for _, z in ipairs(zoneList) do
    local success, result = pcall(function()
        return Workspace.Zones:FindFirstChild(z)
    end)
    if success and result then
        zoneCache[z] = result
    end
end

local eggData = {
    { name = "Summer Egg", zone = "SummerEvent1" },
    { name = "Winter Egg", zone = "WinterEvent1" },
    { name = "Sphinx Egg", zone = "EleEgg1" },
    { name = "Desert Egg", zone = "6" },
    { name = "Swamp Egg", zone = "4" },
    { name = "Sky Egg", zone = "15" },
    { name = "Cosmos Egg", zone = "10" },
    { name = "Void Egg", zone = "27" },
    { name = "Tiki Egg", zone = "30" },
    { name = "Tiki Island Egg", zone = "11" },
    { name = "Draco Egg", zone = "34" },
    { name = "Crystal Egg", zone = "12.1" },
    { name = "Octopus Egg", zone = "30" },
    { name = "Forest Egg", zone = "1" },
    { name = "Frozen Egg", zone = "3" },
    { name = "Magma Egg", zone = "7" },
    { name = "Atlantis Egg", zone = "8" },
    { name = "Aqua Egg", zone = "9" },
    { name = "Egg Of Oblivion", zone = "12" },
    { name = "Mythical Egg", zone = "13" },
    { name = "Legendary Egg", zone = "14" },
    { name = "Naga Boss Egg", zone = "Boss1" },
    { name = "Lava Monster Boss Egg", zone = "Boss2" },
    { name = "Tiki Boss Egg", zone = "Boss4" },
}

local function getZone(name)
    return zoneCache[name]
end

local function getPets()
    if not petCacheValid then
        if LocalPlayer.Character then
            local pets = LocalPlayer.Character:FindFirstChild("Pets")
            petCache = pets and pets:GetChildren() or {}
        else
            petCache = {}
        end
        petCacheValid = true
    end
    return petCache
end

if LocalPlayer.CharacterAdded then
    LocalPlayer.CharacterAdded:Connect(function()
        petCacheValid = false
    end)
end

if LocalPlayer.Character then
    pcall(function()
        return LocalPlayer.Character.ChildAdded:Connect(function(child)
            if child.Name == "Pets" then
                petCacheValid = false
            end
        end)
    end)
end

local function getNests()
    local now = os.clock()
    if now - lastNestCacheUpdate > 10 or not nestsCache or not nestsCache.Parent then
        nestsCache = Workspace:FindFirstChild("Nests")
        lastNestCacheUpdate = now
    end
    return nestsCache
end

local function attackWithMultiplePets(enemy)
    local pets = getPets()
    if #pets == 0 then return end
    for i = 1, math.min(5, #pets) do
        safeCombat("AttackEnemy", enemy, pets[i])
    end
end

local function attackEnemy(zoneName, enemyName, needsRequest)
    if needsRequest then
        requestZoneMap(zoneName)
        task.wait(0.1)
    end
    local zone = getZone(zoneName)
    if zone and zone:FindFirstChild("Enemies") then
        local enemy = zone.Enemies:FindFirstChild(enemyName)
        if enemy then
            attackWithMultiplePets(enemy)
        end
    end
end

local function attackAllEnemies(zoneName, needsRequest)
    if needsRequest then
        requestZoneMap(zoneName)
        task.wait(0.1)
    end
    local zone = getZone(zoneName)
    if zone and zone:FindFirstChild("Enemies") then
        local enemies = zone.Enemies:GetChildren()
        for _, enemy in ipairs(enemies) do
            attackWithMultiplePets(enemy)
        end
    end
end

local bossThreads = {}
local function bossWorker(threadId)
    while active and bossThreads[threadId] and config.farmBosses do
        if #activeBosses > 0 then
            local pets = getPets()
            if #pets > 0 then
                local idx = 1
                for _, boss in ipairs(activeBosses) do
                    if boss and boss.Parent then
                        safeCombat("AttackEnemy", boss, pets[idx])
                        idx = idx % #pets + 1
                    end
                end
            end
        end
        task.wait(config.bossSpeed)
    end
end

local enemyThreads = {}
local function enemyWorker(threadId)
    while active and enemyThreads[threadId] do
        for idx, enemy in ipairs(enemyList) do
            if enemyEnabled[idx] then
                if enemy.attackAll then
                    attackAllEnemies(enemy.zone, enemy.needsRequest)
                else
                    attackEnemy(enemy.zone, enemy.enemy, enemy.needsRequest)
                end
            end
        end
        task.wait(config.foodSpeed)
    end
end

local foodThreads = {}
local function foodWorker(threadId)
    while active and foodThreads[threadId] do
        for _, foodZone in ipairs(foodZones) do
            if foodZone.enabled then
                local zone = getZone(foodZone.zone)
                if zone and zone:FindFirstChild("FoodSpawns") then
                    local foods = zone.FoodSpawns:GetChildren()
                    for _, f in ipairs(foods) do
                        local pets = getPets()
                        for i = 1, math.min(5, #pets) do
                            safeCollect("CollectFood", f, pets[i])
                        end
                    end
                end
            end
        end
        task.wait(config.foodSpeed)
    end
end

local function scanBosses()
    if not config.farmBosses then return end
    local newActive = {}
    for _, name in ipairs(bossList) do
        if bossEnabled[name] then
            local zone = getZone(bossZoneMap[name])
            local enemy = zone and zone:FindFirstChild("Enemies") and zone.Enemies:FindFirstChild(name)
            if enemy then
                table.insert(newActive, enemy)
            end
        end
    end
    activeBosses = newActive
end

local function tickSacrifice()
    if not (config.sacrificeLoopQueen or config.sacrificeLoopKing or 
            config.sacrificeLoopFrozen or config.sacrificeLoopWalrus) then return end
    updateActivity()
    if config.sacrificeLoopQueen then
        safeSacrifice("Queen Bee")
    end
    if config.sacrificeLoopKing then
        safeSacrifice("King Bee")
    end
    if config.sacrificeLoopFrozen then
        safeSacrifice("Frozen Werewolf")
    end
    if config.sacrificeLoopWalrus then
        safeSacrifice("Walrus")
    end
end

-- EGGS ULTRA RÁPIDOS - THREADS DEDICADAS
local plantThreads = {}
local function plantWorker(threadId)
    while active and plantThreads[threadId] and config.autoPlant do
        if #eggsSelected > 0 then
            for _, zone in ipairs(eggsSelected) do
                for _ = 1, 9 do
                    safePlant(zone)
                end
            end
        end
        task.wait(0.001) -- Delay mínimo para não travar
    end
end

local hatchThreads = {}
local function hatchWorker(threadId)
    while active and hatchThreads[threadId] and config.autoHatch do
        safeHatch()
        task.wait(0.001)
    end
end

local nestsThreads = {}
local function nestsWorker(threadId)
    while active and nestsThreads[threadId] and config.autoNests do
        local nests = getNests()
        if nests then
            for _, nest in ipairs(nests:GetChildren()) do
                safeFeed(nest)
            end
        end
        task.wait(0.001)
    end
end

local function saveCheckpoint()
    checkpointData = {
        eggsSelected = {},
        bossEnabled = {},
        enemyEnabled = {},
        foodZones = {},
        config = {}
    }
    for _, v in ipairs(eggsSelected) do
        table.insert(checkpointData.eggsSelected, v)
    end
    for k, v in pairs(bossEnabled) do
        checkpointData.bossEnabled[k] = v
    end
    for k, v in pairs(enemyEnabled) do
        checkpointData.enemyEnabled[k] = v
    end
    for k, v in pairs(foodZones) do
        checkpointData.foodZones[k] = { name = v.name, zone = v.zone, enabled = v.enabled }
    end
    for k, v in pairs(config) do
        checkpointData.config[k] = v
    end
end

local lastAction = {
    sacrifice = 0, bossScan = 0
}

local function canDoAction(action, cooldown)
    local now = os.clock()
    if now - lastAction[action] >= cooldown then
        lastAction[action] = now
        return true
    end
    return false
end

local crashDetected = false
local scanThreadHandle = nil

local function mainLoop()
    while active do
        cycleCount = cycleCount + 1
        local startTime = os.clock()
        
        if os.clock() - lastCheckpoint > 300 then
            saveCheckpoint()
            lastCheckpoint = os.clock()
        end
        
        if os.clock() - lastActivity > 60 and active then
            crashDetected = true
            stop()
            task.wait(2)
            start()
            lastActivity = os.clock()
        end
        
        tickSacrifice()
        
        local elapsed = os.clock() - startTime
        if elapsed < 0.1 then
            task.wait(0.1 - elapsed)
        else
            task.wait(0.05)
        end
    end
end

local function bossScanLoop()
    while active do
        if canDoAction("bossScan", 15) then
            scanBosses()
        end
        task.wait(1)
    end
end

local function watchdog()
    while true do
        task.wait(5)
        if active then
            for i = 1, config.bossThreads do
                if not bossThreads[i] then
                    bossThreads[i] = true
                    task.spawn(function() bossWorker(i) end)
                end
            end
            for i = 1, config.enemyThreads do
                if not enemyThreads[i] then
                    enemyThreads[i] = true
                    task.spawn(function() enemyWorker(i) end)
                end
            end
            for i = 1, config.foodThreads do
                if not foodThreads[i] then
                    foodThreads[i] = true
                    task.spawn(function() foodWorker(i) end)
                end
            end
            -- Eggs threads (sempre 3 threads cada para máxima velocidade)
            for i = 1, 3 do
                if not plantThreads[i] then
                    plantThreads[i] = true
                    task.spawn(function() plantWorker(i) end)
                end
                if not hatchThreads[i] then
                    hatchThreads[i] = true
                    task.spawn(function() hatchWorker(i) end)
                end
                if not nestsThreads[i] then
                    nestsThreads[i] = true
                    task.spawn(function() nestsWorker(i) end)
                end
            end
            if not scanThreadHandle or not task.isrunning(scanThreadHandle) then
                if scanThreadHandle then task.cancel(scanThreadHandle) end
                scanThreadHandle = task.spawn(bossScanLoop)
            end
        end
    end
end

local GlobalConnections = {
    list = {},
    add = function(self, name, conn)
        if self.list[name] then
            self.list[name]:Disconnect()
        end
        self.list[name] = conn
    end,
    remove = function(self, name)
        if self.list[name] then
            self.list[name]:Disconnect()
            self.list[name] = nil
        end
    end,
    clear = function(self)
        for _, conn in pairs(self.list) do
            conn:Disconnect()
        end
        self.list = {}
    end
}

local watchdogThread = task.spawn(watchdog)

local function start()
    if startDebounce or active then return end
    startDebounce = true
    task.delay(1, function() startDebounce = false end)
    
    active = true
    petCacheValid = false
    lastActivity = os.clock()
    
    task.spawn(mainLoop)
    scanThreadHandle = task.spawn(bossScanLoop)
    
    for i = 1, config.bossThreads do
        bossThreads[i] = true
        task.spawn(function() bossWorker(i) end)
    end
    for i = 1, config.enemyThreads do
        enemyThreads[i] = true
        task.spawn(function() enemyWorker(i) end)
    end
    for i = 1, config.foodThreads do
        foodThreads[i] = true
        task.spawn(function() foodWorker(i) end)
    end
    -- Eggs threads já serão iniciadas pelo watchdog
end

local function stop()
    active = false
    bossThreads = {}
    enemyThreads = {}
    foodThreads = {}
    plantThreads = {}
    hatchThreads = {}
    nestsThreads = {}
    if scanThreadHandle then task.cancel(scanThreadHandle) scanThreadHandle = nil end
    activeBosses = {}
    petCacheValid = false
    GlobalConnections:clear()
end

local win = Rayfield:CreateWindow({
    Name = "Maveryk Hub - Pet Swarm Simulator",
    LoadingTitle = "Loading...",
    LoadingSubtitle = "Ultimate Edition",
    ConfigurationSaving = { Enabled = true, FolderName = "MaverykHub", FileName = "Config" },
    Theme = "Dark"
})

local mainTab = win:CreateTab("Main")
mainTab:CreateSection("Control")
mainTab:CreateButton({ Name = "Start Farming", Callback = start })
mainTab:CreateButton({ Name = "Stop Farming", Callback = stop })

mainTab:CreateSection("Status")
local statusLabel = mainTab:CreateLabel("Status: Stopped")
local bossStatus = mainTab:CreateLabel("Bosses: OFF")
local enemyStatus = mainTab:CreateLabel("Enemies: OFF")
local foodStatus = mainTab:CreateLabel("Food: OFF")
local eggStatus = mainTab:CreateLabel("Eggs: OFF")
local nestStatus = mainTab:CreateLabel("Nests: OFF")
local sacrificeStatus = mainTab:CreateLabel("Sacrifice: OFF")
local miscStatus = mainTab:CreateLabel("Misc: OFF")
local perfStatus = mainTab:CreateLabel("Performance: Normal")

task.spawn(function()
    while true do
        task.wait(0.5)
        if active then
            statusLabel:Set("Status: Active")
            bossStatus:Set("Bosses: " .. (config.farmBosses and "ON" or "OFF"))
            
            local anyEnemy = false
            for _, enabled in pairs(enemyEnabled) do
                if enabled then anyEnemy = true break end
            end
            enemyStatus:Set("Enemies: " .. (anyEnemy and "ON" or "OFF"))
            
            local anyFood = false
            for _, foodZone in ipairs(foodZones) do
                if foodZone.enabled then anyFood = true break end
            end
            foodStatus:Set("Food: " .. (anyFood and "ON" or "OFF"))
            
            eggStatus:Set("Eggs: " .. ((config.autoPlant or config.autoHatch) and "ON" or "OFF"))
            nestStatus:Set("Nests: " .. (config.autoNests and "ON" or "OFF"))
            
            local sacOn = config.sacrificeLoopQueen or config.sacrificeLoopKing or config.sacrificeLoopFrozen or config.sacrificeLoopWalrus
            sacrificeStatus:Set("Sacrifice: " .. (sacOn and "ON" or "OFF"))
            
            local miscOn = config.doubleJump
            miscStatus:Set("Misc: " .. (miscOn and "ON" or "OFF"))
            perfStatus:Set("Performance: " .. (performance.mode == "eco" and "Eco" or "Normal"))
        else
            statusLabel:Set("Status: Stopped")
            bossStatus:Set("Bosses: OFF")
            enemyStatus:Set("Enemies: OFF")
            foodStatus:Set("Food: OFF")
            eggStatus:Set("Eggs: OFF")
            nestStatus:Set("Nests: OFF")
            sacrificeStatus:Set("Sacrifice: OFF")
            miscStatus:Set("Misc: OFF")
            perfStatus:Set("Performance: Normal")
        end
    end
end)

mainTab:CreateSection("Credits")
mainTab:CreateLabel("developed by Maveryk1t")
mainTab:CreateLabel("the best script for Pet Swarm Simulator")
mainTab:CreateLabel("yt: Maveryk1t")
mainTab:CreateLabel("discord: knzd1")

local enemiesTab = win:CreateTab("Enemies")
enemiesTab:CreateSection("Enemy Farming")
enemiesTab:CreateToggle({ Name = "Enable All Enemies", CurrentValue = false, Callback = function(v)
    for i = 1, #enemyList do
        enemyEnabled[i] = v
    end
    saveCheckpoint()
end })

enemiesTab:CreateSection("Event Enemies")
enemiesTab:CreateToggle({ Name = "Summer (All)", CurrentValue = enemyEnabled[1], Callback = function(v) enemyEnabled[1] = v; saveCheckpoint() end })
enemiesTab:CreateToggle({ Name = "Winter (All)", CurrentValue = enemyEnabled[2], Callback = function(v) enemyEnabled[2] = v; saveCheckpoint() end })
enemiesTab:CreateToggle({ Name = "Sphinx (Evil Eagle)", CurrentValue = enemyEnabled[3], Callback = function(v) enemyEnabled[3] = v; saveCheckpoint() end })

enemiesTab:CreateSection("Desert")
enemiesTab:CreateToggle({ Name = "Cursed Mummy", CurrentValue = enemyEnabled[4], Callback = function(v) enemyEnabled[4] = v; saveCheckpoint() end })

enemiesTab:CreateSection("Sky")
enemiesTab:CreateToggle({ Name = "Crazy Unicorn", CurrentValue = enemyEnabled[5], Callback = function(v) enemyEnabled[5] = v; saveCheckpoint() end })

enemiesTab:CreateSection("Tiki")
enemiesTab:CreateToggle({ Name = "Terror Tree", CurrentValue = enemyEnabled[6], Callback = function(v) enemyEnabled[6] = v; saveCheckpoint() end })

enemiesTab:CreateSection("Draco")
enemiesTab:CreateToggle({ Name = "Draco's Guard", CurrentValue = enemyEnabled[7], Callback = function(v) enemyEnabled[7] = v; saveCheckpoint() end })

enemiesTab:CreateSection("Settings")
enemiesTab:CreateSlider({ Name = "Enemy Threads", Range = {1, 10}, Increment = 1, CurrentValue = config.enemyThreads, Callback = function(v) config.enemyThreads = v; saveCheckpoint() end })
enemiesTab:CreateLabel("5 pets per enemy attack")

local foodTab = win:CreateTab("Food")
foodTab:CreateSection("Food Zones")
foodTab:CreateLabel("Select which zones to farm:")

foodTab:CreateToggle({ 
    Name = foodZones[1].name, 
    CurrentValue = foodZones[1].enabled, 
    Callback = function(v) 
        foodZones[1].enabled = v 
        saveCheckpoint()
    end 
})

foodTab:CreateToggle({ 
    Name = foodZones[2].name, 
    CurrentValue = foodZones[2].enabled, 
    Callback = function(v) 
        foodZones[2].enabled = v 
        saveCheckpoint()
    end 
})

foodTab:CreateSection("Settings")
foodTab:CreateLabel("• 5 pets per food item")
foodTab:CreateSlider({ Name = "Food Threads", Range = {1, 10}, Increment = 1, CurrentValue = config.foodThreads, Callback = function(v) config.foodThreads = v; saveCheckpoint() end })
foodTab:CreateSlider({ Name = "Speed (s)", Range = {0.001, 1}, Increment = 0.001, Suffix = "s", CurrentValue = config.foodSpeed, Callback = function(v) config.foodSpeed = v; saveCheckpoint() end })

local bossTab = win:CreateTab("Bosses")
bossTab:CreateSection("Boss Control")
bossTab:CreateToggle({ Name = "Enable Boss Farming", CurrentValue = config.farmBosses, Callback = function(v) config.farmBosses = v; saveCheckpoint() end })
bossTab:CreateToggle({ Name = "Enable All Bosses", CurrentValue = true, Callback = function(v)
    for _, name in ipairs(bossList) do bossEnabled[name] = v end
    saveCheckpoint()
end })
bossTab:CreateSlider({ Name = "Boss Threads", Range = {1, 5}, Increment = 1, CurrentValue = config.bossThreads, Callback = function(v) config.bossThreads = v; saveCheckpoint() end })
bossTab:CreateSlider({ Name = "Attack Speed (s)", Range = {0.01, 0.3}, Increment = 0.01, Suffix = "s", CurrentValue = config.bossSpeed, Callback = function(v) config.bossSpeed = v; saveCheckpoint() end })
bossTab:CreateLabel("Boss scan every 15 seconds")

bossTab:CreateSection("Boss List")
for _, name in ipairs(bossList) do
    bossTab:CreateToggle({
        Name = name,
        CurrentValue = bossEnabled[name],
        Callback = function(v) bossEnabled[name] = v; saveCheckpoint() end
    })
end

local eggTab = win:CreateTab("Eggs")
eggTab:CreateSection("EGGS ULTRA RÁPIDO")
eggTab:CreateLabel("⚡ 3 THREADS POR FUNÇÃO ⚡")
eggTab:CreateLabel("Nunca para - sempre ativo")

eggTab:CreateSection("PLANT")
eggTab:CreateToggle({ Name = "Enable Auto Plant", CurrentValue = config.autoPlant, Callback = function(v) config.autoPlant = v; saveCheckpoint() end })
eggTab:CreateLabel("• 9 eggs per zone")
eggTab:CreateLabel("• 3 threads paralelas")

eggTab:CreateSection("HATCH")
eggTab:CreateToggle({ Name = "Enable Auto Hatch", CurrentValue = config.autoHatch, Callback = function(v) config.autoHatch = v; saveCheckpoint() end })
eggTab:CreateLabel("• 1 hatch per cycle")
eggTab:CreateLabel("• 3 threads paralelas")

eggTab:CreateSection("NESTS")
eggTab:CreateToggle({ Name = "Enable Auto Nests", CurrentValue = config.autoNests, Callback = function(v) config.autoNests = v; saveCheckpoint() end })
eggTab:CreateLabel("• All nests per cycle")
eggTab:CreateLabel("• 3 threads paralelas")

eggTab:CreateSection("Select Eggs to Plant")
for _, egg in ipairs(eggData) do
    eggTab:CreateToggle({
        Name = egg.name,
        CurrentValue = false,
        Callback = function(val)
            if val then
                if not table.find(eggsSelected, egg.zone) then
                    table.insert(eggsSelected, egg.zone)
                end
            else
                local idx = table.find(eggsSelected, egg.zone)
                if idx then table.remove(eggsSelected, idx) end
            end
            saveCheckpoint()
        end
    })
end

eggTab:CreateButton({
    Name = "Remove Hatch Animation",
    Callback = function()
        local ev = ReplicatedStorage and ReplicatedStorage:FindFirstChild("Remotes") and ReplicatedStorage.Remotes:FindFirstChild("Events")
        if ev and ev:FindFirstChild("HatchAnimationEvent") then
            ev.HatchAnimationEvent:Destroy()
        end
    end
})

local sacrificeTab = win:CreateTab("Sacrifices")
sacrificeTab:CreateSection("Mythical")
sacrificeTab:CreateToggle({ Name = "Queen Bee (Mythical) - Loop", CurrentValue = config.sacrificeLoopQueen, Callback = function(v) config.sacrificeLoopQueen = v; saveCheckpoint() end })
sacrificeTab:CreateButton({ Name = "Sacrifice Queen Bee (Once)", Callback = function() safeSacrifice("Queen Bee") end })
sacrificeTab:CreateToggle({ Name = "Frozen Werewolf (Mythical) - Loop", CurrentValue = config.sacrificeLoopFrozen, Callback = function(v) config.sacrificeLoopFrozen = v; saveCheckpoint() end })
sacrificeTab:CreateButton({ Name = "Sacrifice Frozen Werewolf (Once)", Callback = function() safeSacrifice("Frozen Werewolf") end })

sacrificeTab:CreateSection("Legendary")
sacrificeTab:CreateToggle({ Name = "King Bee (Legendary) - Loop", CurrentValue = config.sacrificeLoopKing, Callback = function(v) config.sacrificeLoopKing = v; saveCheckpoint() end })
sacrificeTab:CreateButton({ Name = "Sacrifice King Bee (Once)", Callback = function() safeSacrifice("King Bee") end })
sacrificeTab:CreateToggle({ Name = "Walrus (Legendary) - Loop", CurrentValue = config.sacrificeLoopWalrus, Callback = function(v) config.sacrificeLoopWalrus = v; saveCheckpoint() end })
sacrificeTab:CreateButton({ Name = "Sacrifice Walrus (Once)", Callback = function() safeSacrifice("Walrus") end })

local miscTab = win:CreateTab("Misc")
miscTab:CreateSection("Movement")

miscTab:CreateToggle({ Name = "Infinite Double Jump", CurrentValue = config.doubleJump, Callback = function(v)
    config.doubleJump = v
    if v then
        local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid:SetStateEnabled(Enum.HumanoidStateType.Jumping, true)
            jumpCount = 0
            if not jumpConnection then
                jumpConnection = humanoid.Jumping:Connect(function()
                    jumpCount = jumpCount + 1
                    if jumpCount >= 2 then
                        humanoid.Jump = true
                        jumpCount = 0
                    end
                end)
                GlobalConnections:add("jump", jumpConnection)
            end
        end
    elseif jumpConnection then
        jumpConnection:Disconnect()
        jumpConnection = nil
        jumpCount = 0
    end
    saveCheckpoint()
end })

miscTab:CreateSlider({ Name = "Walk Speed", Range = {16, 100}, Increment = 1, Suffix = "", CurrentValue = config.wallspeed, Callback = function(v)
    config.wallspeed = v
    local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
    if humanoid then
        humanoid.WalkSpeed = v
    end
    saveCheckpoint()
end })

miscTab:CreateSection("Hotkey")
miscTab:CreateLabel("Press H to hide/show GUI")

local guiVisible = true
UserInputService.InputBegan:Connect(function(input, gp)
    if not gp and input.KeyCode == Enum.KeyCode.H then
        guiVisible = not guiVisible
        for _, v in pairs(win:GetChildren()) do
            if v:IsA("ScreenGui") then
                v.Enabled = guiVisible
            end
        end
    end
end)

game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "Maveryk Hub",
    Text = "Script loaded successfully!",
    Duration = 3
})
